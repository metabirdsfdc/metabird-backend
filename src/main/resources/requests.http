### =====================================================
### VARIABLES (EDIT TOKEN ONCE)
### =====================================================
@baseUrl = http://localhost:8080
@token = eyJhbGciOiJIUzUxMiJ9.eyJyb2xlcyI6W3siYXV0aG9yaXR5IjoiUk9MRV9VU0VSIn1dLCJzdWIiOiJwYXZhbmthbHlhbkBnbWFpbC5jb20iLCJpYXQiOjE3NjU4MDUzOTAsImV4cCI6MTc2NTgwODk5MH0.wHBn9DDqI0GD22lB4xcKAslgzPPm24olMOzcuh9r0UObLbIfGDj2aZ7KQTptP7_SNmWBXQ_Dxl7PCJE2MFhDQQ


### =====================================================
### 1Ô∏è‚É£ CREATE / UPDATE Salesforce Session
### POST /api/organizations
### =====================================================
POST {{baseUrl}}/api/organizations
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "userId": "SF-USER-001",
  "organizationId": "ORG-001",
  "sessionId": "SID-001",
  "serverUrl": "https://login.salesforce.com",
  "metadataServerUrl": "https://metadata.salesforce.com",
  "sandbox": false,
  "passwordExpired": false,
  "userFullName": "Admin One",
  "userEmail": "admin@orgone.com",
  "organizationName": "Org One",
  "sessionSecondsValid": 7200
}

### EXPECTED
# 200 OK
# true


### =====================================================
### 2Ô∏è‚É£ CREATE SECOND SESSION
### =====================================================
POST {{baseUrl}}/api/organizations
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "userId": "SF-USER-002",
  "organizationId": "ORG-002",
  "sessionId": "SID-002",
  "serverUrl": "https://test.salesforce.com",
  "metadataServerUrl": "https://test-metadata.salesforce.com",
  "sandbox": true,
  "passwordExpired": false,
  "userFullName": "Admin Two",
  "userEmail": "admin@orgtwo.com",
  "organizationName": "Org Two",
  "sessionSecondsValid": 3600
}

### EXPECTED
# 200 OK
# true


### =====================================================
### 3Ô∏è‚É£ GET ALL SESSIONS (AUTHENTICATED USER)
### GET /api/organizations
### =====================================================
GET {{baseUrl}}/api/organizations
Authorization: Bearer {{token}}

### EXPECTED
# 200 OK
# [
#   { session for ORG-001 },
#   { session for ORG-002 }
# ]


### =====================================================
### 4Ô∏è‚É£ GET SINGLE SESSION BY IDENTIFIER (email)
### GET /api/organizations/{identifier}
### =====================================================
GET {{baseUrl}}/api/organizations/admin@orgtwo.com
Authorization: Bearer {{token}}

### EXPECTED
# 200 OK
# { session for ORG-002 }


### =====================================================
### 5Ô∏è‚É£ UPDATE EXISTING SESSION (same identifier)
### =====================================================
POST {{baseUrl}}/api/organizations
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "userId": "SF-USER-002",
  "organizationId": "ORG-002",
  "sessionId": "SID-002-UPDATED",
  "serverUrl": "https://test.salesforce.com",
  "metadataServerUrl": "https://test-metadata.salesforce.com",
  "sandbox": true,
  "passwordExpired": false,
  "userFullName": "Admin Two Updated",
  "userEmail": "admin@orgtwo.com",
  "organizationName": "Org Two UPDATED",
  "sessionSecondsValid": 9999
}

### EXPECTED
# 200 OK
# true


### =====================================================
### 6Ô∏è‚É£ VERIFY UPDATE
### =====================================================
GET {{baseUrl}}/api/organizations/admin@orgtwo.com
Authorization: Bearer {{token}}

### EXPECTED
# organizationName = "Org Two UPDATED"
# sessionId = "SID-002-UPDATED"


### =====================================================
### 7Ô∏è‚É£ DELETE SESSION BY IDENTIFIER
### DELETE /api/organizations/{identifier}
### =====================================================
DELETE {{baseUrl}}/api/organizations/admin@orgone.com
Authorization: Bearer {{token}}

### EXPECTED
# 200 OK
# true


### =====================================================
### 8Ô∏è‚É£ GET ALL AFTER DELETE
### =====================================================
GET {{baseUrl}}/api/organizations
Authorization: Bearer {{token}}

### EXPECTED
# [
#   { session for ORG-002 only }
# ]


### =====================================================
### 9Ô∏è‚É£ UNAUTHORIZED TEST (NO TOKEN)
### =====================================================
GET {{baseUrl}}/api/organizations

### EXPECTED
# 401 Unauthorized


### =====================================================
### üîü INVALID TOKEN TEST
### =====================================================
GET {{baseUrl}}/api/organizations
Authorization: Bearer invalid.token.here

### EXPECTED
# 401 Unauthorized
